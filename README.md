# Восстановление золота из руды
  * [Описание исследования](#Описание-исследования)
  * [Технологический процесс](#Технологический-процесс)
  * [Общий вывод](#Общий-вывод)
## Описание исследования
Подготовьте прототип модели машинного обучения для «Цифры».<br>
Компания разрабатывает решения для эффективной работы промышленных предприятий.

Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

Вам нужно:

1. Подготовить данные;
2. Провести исследовательский анализ данных;
3. Построить и обучить модель.

Используйте данные с параметрами добычи и очистки.

Чтобы выполнить проект, обращайтесь к библиотекам *pandas*, *matplotlib* и *sklearn.* Вам поможет их документация.

<b><i>Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды.<br></b></i>

## Технологический процесс

<img src="https://pictures.s3.yandex.net/resources/viruchka_1576238830.jpg" />

* `Rougher feed` — исходное сырье
* `Rougher additions` (или reagent additions) — флотационные реагенты: Xanthate, Sulphate, Depressant
* `Xanthate` ** — ксантогенат (промотер, или активатор флотации);
* `Sulphate` — сульфат (на данном производстве сульфид натрия);
* `Depressant` — депрессант (силикат натрия).
* `Rougher process` (англ. «грубый процесс») — флотация
* `Rougher tails` — отвальные хвосты
* `Float banks` — флотационная установка
* `Cleaner process` — очистка
* `Rougher Au` — черновой концентрат золота
* `Final Au` — финальный концентрат золота

**Параметры этапов**

* `air amount` — объём воздуха
* `fluid levels` — уровень жидкости
* `feed size` — размер гранул сырья
* `feed rate` — скорость подачи

Наименование признаков должно быть такое:<br>
`[этап].[тип_параметра].[название_параметра]`<br>
Пример: `rougher.input.feed_ag`

Возможные значения для блока `[этап]`:
* `rougher` — флотация
* `primary_cleaner` — первичная очистка
* `secondary_cleaner` — вторичная очистка
* `final` — финальные характеристики

Возможные значения для блока `[тип_параметра]`:
* `input` — параметры сырья
* `output` — параметры продукта
* `state` — параметры, характеризующие текущее состояние этапа
* `calculation` — расчётные характеристики

Целевые признаки: `rougher.output.recovery` и `final.output.recovery`

**Формула расчёта эффективности**
<br><br>
<!-- Recovery\ =\ \frac{C\ \times \ ( F\ - T)}{F\ \times \ ( C\ - T)} \ \times \ 100\% -->
![](http://www.sciweavers.org/upload/Tex2Img_1677790885/render.png)
<br>
* `C` — доля золота в концентрате после флотации / очистки;
* `F` — доля золота в сырье / концентрате до флотации / очистки;
* `T` — доля золота в отвальных хвостах после флотации / очистки.

**Формула метрики**
 
`sMAPE` (англ. Symmetric Mean Absolute Percentage Error, «симметричное среднее абсолютное процентное отклонение»).
<br><br>
<!-- sMAPE = \frac{1}{N}\sum_{i=1}^{N}\frac{\left| y_{i} - \hat{y_{i}} \right|}{(\left| y_{i} \right| + \left|\hat{y_{i}}\right|)/2}\times100\% -->
![](http://www.sciweavers.org/upload/Tex2Img_1677790328/render.png)
<br>
![](http://www.sciweavers.org/upload/Tex2Img_1677790210/render.png) 
 — значение целевого признака для объекта с порядковым номером i в выборке, на которой измеряется качество.
<br>
<!-- \widehat{y_{i}} -->
![](http://www.sciweavers.org/upload/Tex2Img_1677789802/render.png)
 — значение предсказания для объекта с порядковым номером i, например, в тестовой выборке.
<br>
![](http://www.sciweavers.org/upload/Tex2Img_1677789662/render.png)
 — количество объектов в выборке.

**Формула итоговой метрики**
<br><br>
<!-- final\_sMAPE = 25\% \times sMAPE(rougher) + 75\% \times sMAPE(final) -->
![](http://www.sciweavers.org/upload/Tex2Img_1677785523/render.png)
<br>

## Общий вывод
* Почему-то при кросс-валидации подобрались параметры:<br>
    `n_estimators = 18`, `depth = 5`;<br>
    подбирались более 12 часов в диапазонах `depth 1..15`, `n_estimators 1..51`<br>
    Почему-то показывают худшие показатели на тестовой выборке, чем подобранные вручную (`n_estimators = 20`, `depth = 4`).<br>
* <b>Разница между проверочной моделью и финальной моделью на тестовых данных ≈ 0,5%.</b><br>
    Это не очень много, пробовал разные методы заполнения пропусков: `.fillna()`, `.ffill()`, `.interpolate()`.<br>
    Но улучшить показатели не получилось (параметры в течение 12 часов подбирались только один раз).<br>
    Возможно, что если дольше подбирать параметры заполнения пропусков и параметры модели, то получится уменьшить ошибку.<br>
    Возможно, стоит добиться наличия утраченных признаков в тестовой выборке, если это возможно.<br>
***
_Работа над проектом велась в PyCharm 2021.3.2 (Professional Edition)_<br>
_формат ячеек Markdown различается в веб-версии и в PyCharm_